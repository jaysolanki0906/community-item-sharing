<mat-card class="table-container mat-elevation-z4">
  <div *ngIf="(filterOptions?.length ?? 0) > 0" class="segmented-button-group">
    <button 
      *ngFor="let option of filterOptions"
      [class.active]="selectedFilter === option.value"
      (click)="selectFilter(option.value)"
      class="filter-button">
      <mat-icon *ngIf="selectedFilter === option.value">check</mat-icon>
      {{ option.label }}
    </button>
  </div>

  <div class="table-wrapper" *ngIf="!Loading; else loader">
    <table mat-table [dataSource]="dataSource" class="mat-elevation-z1 custom-table">

      <ng-container *ngFor="let col of displayedColumns" [matColumnDef]="col">
        <th mat-header-cell *matHeaderCellDef class="custom-header">
          {{ col | titlecase }}
        </th>
        <td mat-cell *matCellDef="let element">
          <ng-container [ngSwitch]="col">

            <ng-container *ngSwitchCase="'imageUrl'">
              <button mat-button color="primary" (click)="openImageDialog(element[col])">
                <mat-icon>image</mat-icon> View Image
              </button>
            </ng-container>

            <ng-container *ngSwitchCase="'actions'">
              <button *ngFor="let btn of actionButtons"
                      mat-icon-button
                      [color]="btn.type === 'delete' ? 'warn' : 'primary'"
                      matTooltip="{{ btn.label }}"
                      (click)="actionClicked.emit({ action: btn.type, row: element })">
                <mat-icon>
      {{ btn.type === 'toggleStatus' ? (element.isActive ? 'toggle_on' : 'toggle_off') : (btn.icon || 'more_vert') }}
    </mat-icon>
              </button>
            </ng-container>

            <ng-container *ngSwitchDefault>
              {{ element[col] }}
            </ng-container>

          </ng-container>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
    </table>
  </div>
  <ng-template #loader>
  <div class="loader-container" style="text-align: center; padding: 40px;">
    <mat-spinner diameter="40"></mat-spinner>
  </div>
</ng-template>

  <mat-paginator
    [length]="totalItems"
    [pageSize]="pageSize"
    [pageSizeOptions]="[5, 10, 20]"
    (page)="onPageChange($event)">
  </mat-paginator>
</mat-card>
